clc;clear all;
n = 2;% input('Enter number of buildings in urban environment: ');

rotate3d;
z = 600;%input('Enter the height of UAV: ');
const1 = 0;const2 = 1500;
R = [750,0,0];%input('Enter the point on the road: ');


ad = [300,200,200];%input('Enter [l,w,h] of 1st building: ');
bd = [300,200,300];%input('Enter [l,w,h] of 2nd 1building: ');
wr = 200;%input('Enter width of the road: ');

a = [0,750,0];%input('Enter centre of building: ');
b = [0,750,0];
a(1,1) = 750 + (wr/2) + (ad(1,2)/2);
b(1,1) = 750 - (wr/2) - (bd(1,2)/2);

la = ad(1,1);wa = ad(1,2);ha = ad(1,3);

lb = bd(1,1);wb = bd(1,2);hb = bd(1,3);


R(1,2) = 750 - (la/2) + 0.00001;%input('Enter y coordinate of point on road: ');

plot3(R(1,1),R(1,2),0,'-x');

if (R(1,2)<=750+(la/2)) && (R(1,2)>=750-(la/2)) && (R(1,2)<=750+(lb/2)) && (R(1,2)>=750-(lb/2)) 

P1(1,1) = R(1,1) + (wr/2)*((const2 - R(1,2))/(750+(la/2) - R(1,2)));P1(1,2) = const2;

P2(1,1) = R(1,1) + (wr/2)*(z/ha);P2(1,2) = R(1,2) + (750+(la/2)- R(1,2))*(z/ha);

P3(1,1) = R(1,1) + (wr/2)*(z/ha);P3(1,2) = R(1,2) + (750 - (la/2) - R(1,2))*(z/ha);

P4(1,1) = R(1,1) + (wr/2)*((const1 - R(1,2))/(750 -(la/2) - R(1,2)));P4(1,2) = const1;

P5(1,1) = R(1,1) + (-wr/2)*((const1 - R(1,2))/(750 -(lb/2) - R(1,2)));P5(1,2) = const1;

P6(1,1) = R(1,1) + (-wr/2)*(z/hb);P6(1,2) = R(1,2) + (750 -(lb/2) - R(1,2))*(z/hb);

P7(1,1) = R(1,1) + (-wr/2)*(z/hb);P7(1,2) = R(1,2) + (750 +(lb/2) - R(1,2))*(z/hb);

P8(1,1) = R(1,1) + (-wr/2)*((const2 - R(1,2))/(750 +(lb/2) - R(1,2)));P8(1,2) = const2;

X = [P1(1,1) P2(1,1) P3(1,1) P4(1,1) P5(1,1) P6(1,1) P7(1,1) P8(1,1)];
Y = [P1(1,2) P2(1,2) P3(1,2) P4(1,2) P5(1,2) P6(1,2) P7(1,2) P8(1,2)];
Z = [z z z z z z z z];

end


if (R(1,2)<750+(la/2)) && (R(1,2)>750-(la/2)) && (R(1,2)<750+(lb/2)) && (R(1,2)<750-(lb/2))

P1(1,1) = R(1,1) + (wr/2)*((const2 - R(1,2))/(750+(la/2) - R(1,2)));P1(1,2) = const2;

P2(1,1) = R(1,1) + (wr/2)*(z/ha);P2(1,2) = R(1,2) + (750+(la/2)- R(1,2))*(z/ha);

P3(1,1) = R(1,1) + (wr/2)*(z/ha);P3(1,2) = R(1,2) + (750 - (la/2) - R(1,2))*(z/ha);

P4(1,1) = R(1,1) + (wr/2)*((const1 - R(1,2))/(750 -(la/2) - R(1,2)));P4(1,2) = const1;

P5(1,1) = const1;P5(1,2) = R(1,2) + (750 - (lb/2) - R(1,2))*((const1 - R(1,1))/(-wb - (wr/2)));

P6(1,1) = R(1,1) + (-(wr/2)-wb)*(z/hb);P6(1,2) = R(1,2) + (750 - (lb/2) - R(1,2))*(z/hb);

P7(1,1) = R(1,1) + (-wr/2)*(z/hb);P7(1,2) = R(1,2) + (750 - (lb/2) - R(1,2))*(z/hb);

P8(1,1) = R(1,1) + (-wr/2)*(z/hb);P8(1,2) = R(1,2) + (750 +(lb/2) - R(1,2))*(z/hb);

P9(1,1) = R(1,1) + (-wr/2)*((const2 - R(1,2))/(750 +(lb/2) - R(1,2)));P9(1,2) = const2;

X = [P1(1,1) P2(1,1) P3(1,1) P4(1,1) 0 P5(1,1) P6(1,1) P7(1,1) P8(1,1) P9(1,1) ];
Y = [P1(1,2) P2(1,2) P3(1,2) P4(1,2) 0 P5(1,2) P6(1,2) P7(1,2) P8(1,2) P9(1,2) ];
Z = [z z z z z z z z z z];

end


if (R(1,2)<750+(la/2)) && (R(1,2)<750-(la/2)) && (R(1,2)<750+(lb/2)) && (R(1,2)>750-(lb/2)) 

P1(1,1) = R(1,1) + (wr/2)*((const2 - R(1,2))/(750+(la/2) - R(1,2)));P1(1,2) = const2;

P2(1,1) = R(1,1) + (wr/2)*(z/ha);P2(1,2) = R(1,2) + (750+(la/2)- R(1,2))*(z/ha);

P3(1,1) = R(1,1) + (wr/2)*(z/ha);P3(1,2) = R(1,2) + (750 - (la/2) - R(1,2))*(z/ha);

P4(1,1) = R(1,1) + ((wr/2) + wa)*(z/ha);P4(1,2) = R(1,2) + (750 - (la/2) - R(1,2))*(z/ha);

P5(1,1) = const2;P5(1,2) = R(1,2) + (750 - (la/2) - R(1,2))*((const2 - R(1,1))/((wr/2) + wa));

P6(1,1) = R(1,1) + (-wr/2)*((const1 - R(1,2))/(750 -(lb/2) - R(1,2)));P6(1,2) = const1;

P7(1,1) = R(1,1) + (-wr/2)*(z/hb);P7(1,2) = R(1,2) + (750 -(lb/2) - R(1,2))*(z/hb);

P8(1,1) = R(1,1) + (-wr/2)*(z/hb);P8(1,2) = R(1,2) + (750 +(lb/2) - R(1,2))*(z/hb);

P9(1,1) = R(1,1) + (-wr/2)*((const2 - R(1,2))/(750 +(lb/2) - R(1,2)));P9(1,2) = const2;

X = [P1(1,1) P2(1,1) P3(1,1) P4(1,1) P5(1,1) 1500 P6(1,1) P7(1,1) P8(1,1) P9(1,1) ];
Y = [P1(1,2) P2(1,2) P3(1,2) P4(1,2) P5(1,2)  0 P6(1,2) P7(1,2) P8(1,2) P9(1,2) ];
Z = [z z z z z z z z z z];

end


if (R(1,2)<750+(la/2)) && (R(1,2)<750-(la/2)) && (R(1,2)<750+(lb/2)) && (R(1,2)<750-(lb/2)) 

P1(1,1) = R(1,1) + (wr/2)*((const2 - R(1,2))/(750+(la/2) - R(1,2)));P1(1,2) = const2;

P2(1,1) = R(1,1) + (wr/2)*(z/ha);P2(1,2) = R(1,2) + (750+(la/2)- R(1,2))*(z/ha);

P3(1,1) = R(1,1) + (wr/2)*(z/ha);P3(1,2) = R(1,2) + (750 - (la/2) - R(1,2))*(z/ha);

P4(1,1) = R(1,1) + ((wr/2) + wa)*(z/ha);P4(1,2) = R(1,2) + (750 - (la/2) - R(1,2))*(z/ha);

P5(1,1) = const2;P5(1,2) = R(1,2) + (750 - (la/2) - R(1,2))*((const2 - R(1,1))/((wr/2) + wa ));

P6(1,1) = const1;P6(1,2) = R(1,2) + (750 - (lb/2) - R(1,2))*((const1 - R(1,1))/(-wb - (wr/2)));

P7(1,1) = R(1,1) + (-(wr/2)-wb)*(z/hb);P7(1,2) = R(1,2) + (750 - (lb/2) - R(1,2))*(z/hb);

P8(1,1) = R(1,1) + (-wr/2)*(z/hb);P8(1,2) = R(1,2) + (750 - (lb/2) - R(1,2))*(z/hb);

P9(1,1) = R(1,1) + (-wr/2)*(z/hb);P9(1,2) = R(1,2) + (750 +(lb/2) - R(1,2))*(z/hb);

P10(1,1) = R(1,1) + (-wr/2)*((const2 - R(1,2))/(750 +(lb/2) - R(1,2)));P10(1,2) = const2;

X = [P1(1,1) P2(1,1) P3(1,1) P4(1,1) P5(1,1) 1500 0 P6(1,1) P7(1,1) P8(1,1) P9(1,1) P10(1,1)];
Y = [P1(1,2) P2(1,2) P3(1,2) P4(1,2) P5(1,2) 0 0 P6(1,2) P7(1,2) P8(1,2) P9(1,2) P10(1,2)];
Z = [z z z z z z z z z z z z];

end


if (R(1,2)<750+(la/2)) && (R(1,2)>750-(la/2)) && (R(1,2)>750+(lb/2)) && (R(1,2)>750-(lb/2)) 

P1(1,1) = R(1,1) + (wr/2)*((const2 - R(1,2))/(750+(la/2) - R(1,2)));P1(1,2) = const2;

P2(1,1) = R(1,1) + (wr/2)*(z/ha);P2(1,2) = R(1,2) + (750+(la/2)- R(1,2))*(z/ha);

P3(1,1) = R(1,1) + (wr/2)*(z/ha);P3(1,2) = R(1,2) + (750 - (la/2) - R(1,2))*(z/ha);

P4(1,1) = R(1,1) + (wr/2)*((const1 - R(1,2))/(750 -(la/2) - R(1,2)));P4(1,2) = const1;

P5(1,1) = R(1,1) + (-wr/2)*((const1 - R(1,2))/(750 -(lb/2) - R(1,2)));P5(1,2) = const1;

P6(1,1) = R(1,1) + (-wr/2)*(z/hb);P6(1,2) = R(1,2) + (750 -(lb/2) - R(1,2))*(z/hb);

P7(1,1) = R(1,1) + (-wr/2)*(z/hb);P7(1,2) = R(1,2) + (750 +(lb/2) - R(1,2))*(z/hb);

P8(1,1) = R(1,1) + (-(wr/2) - wb)*(z/hb);P8(1,2) = R(1,2) + (750 +(lb/2) - R(1,2))*(z/hb);

P9(1,1) = const1;P9(1,2) = R(1,2) + (750 +(lb/2) - R(1,2))*((const1 - R(1,1))/(-(wr/2) - wb));

X = [P1(1,1) P2(1,1) P3(1,1) P4(1,1) P5(1,1) P6(1,1) P7(1,1) P8(1,1) P9(1,1) 0];
Y = [P1(1,2) P2(1,2) P3(1,2) P4(1,2) P5(1,2) P6(1,2) P7(1,2) P8(1,2) P9(1,2) 1500];
Z = [z z z z z z z z z z ];

end


if (R(1,2)>750+(la/2)) && (R(1,2)>750-(la/2)) && (R(1,2)<750+(lb/2)) && (R(1,2)>750-(lb/2)) 

P1(1,1) = const2;P1(1,2) = R(1,1) + (750+(la/2) - R(1,2))*((const2 - R(1,1))/((wr/2) + wa));

P2(1,1) = R(1,1) + ((wr/2)+ wa)*(z/ha);P2(1,2) = R(1,2) + (750+(la/2)- R(1,2))*(z/ha);

P3(1,1) = R(1,1) + (wr/2)*(z/ha);P3(1,2) = R(1,2) + (750+(la/2)- R(1,2))*(z/ha);

P4(1,1) = R(1,1) + (wr/2)*(z/ha);P4(1,2) = R(1,2) + (750 - (la/2) - R(1,2))*(z/ha);

P5(1,1) = R(1,1) + (wr/2)*((const1 - R(1,2))/(750 -(la/2) - R(1,2)));P5(1,2) = const1;

P6(1,1) = R(1,1) + (-wr/2)*((const1 - R(1,2))/(750 -(lb/2) - R(1,2)));P6(1,2) = const1;

P7(1,1) = R(1,1) + (-wr/2)*(z/hb);P7(1,2) = R(1,2) + (750 -(lb/2) - R(1,2))*(z/hb);

P8(1,1) = R(1,1) + (-wr/2)*(z/hb);P8(1,2) = R(1,2) + (750 +(lb/2) - R(1,2))*(z/hb);

P9(1,1) = R(1,1) + (-wr/2)*((const2 - R(1,2))/(750 +(lb/2) - R(1,2)));P9(1,2) = const2;

X = [1500 P1(1,1) P2(1,1) P3(1,1) P4(1,1) P5(1,1) P6(1,1) P7(1,1) P8(1,1) P9(1,1)];
Y = [1500 P1(1,2) P2(1,2) P3(1,2) P4(1,2) P5(1,2) P6(1,2) P7(1,2) P8(1,2) P9(1,2)];
Z = [z z z z z z z z z z];

end


if (R(1,2)>750+(la/2)) && (R(1,2)>750-(la/2)) && (R(1,2)>750+(lb/2)) && (R(1,2)>750-(lb/2)) 

P1(1,1) = const2;P1(1,2) = R(1,2) + (750+(la/2) - R(1,2))*((const2 - R(1,1))/((wr/2) + wa));

P2(1,1) = R(1,1) + ((wr/2)+ wa)*(z/ha);P2(1,2) = R(1,2) + (750+(la/2)- R(1,2))*(z/ha);

P3(1,1) = R(1,1) + (wr/2)*(z/ha);P3(1,2) = R(1,2) + (750+(la/2)- R(1,2))*(z/ha);

P4(1,1) = R(1,1) + (wr/2)*(z/ha);P4(1,2) = R(1,2) + (750 - (la/2) - R(1,2))*(z/ha);

P5(1,1) = R(1,1) + (wr/2)*((const1 - R(1,2))/(750 -(la/2) - R(1,2)));P5(1,2) = const1;

P6(1,1) = R(1,1) + (-wr/2)*((const1 - R(1,2))/(750 -(lb/2) - R(1,2)));P6(1,2) = const1;

P7(1,1) = R(1,1) + (-wr/2)*(z/hb);P7(1,2) = R(1,2) + (750 -(lb/2) - R(1,2))*(z/hb);

P8(1,1) = R(1,1) + (-(wr/2) - wb)*(z/hb);P8(1,2) = R(1,2) + (750 -(lb/2) - R(1,2))*(z/hb);

P9(1,1) = R(1,1) + (-(wr/2) - wb)*(z/hb);P9(1,2) = R(1,2) + (750 +(lb/2) - R(1,2))*(z/hb);

P10(1,1) = const1;P10(1,2) = R(1,2) + (750 +(lb/2) - R(1,2))*((const1 - R(1,1))/(-(wr/2) - wb));

X = [1500 P1(1,1) P2(1,1) P3(1,1) P4(1,1) P5(1,1) P6(1,1) P7(1,1) P8(1,1) P9(1,1) P10(1,1) 0];
Y = [1500 P1(1,2) P2(1,2) P3(1,2) P4(1,2) P5(1,2) P6(1,2) P7(1,2) P8(1,2) P9(1,2) P10(1,2) 1500];
Z = [z z z z z z z z z z z z];

end


R(1,2) = 750 + (la/2) - 0.00001;

hold on 

plot3(R(1,1),R(1,2),0,'-x');

if (R(1,2)<=750+(la/2)) && (R(1,2)>=750-(la/2)) && (R(1,2)<=750+(lb/2)) && (R(1,2)>=750-(lb/2)) 

P1(1,1) = R(1,1) + (wr/2)*((const2 - R(1,2))/(750+(la/2) - R(1,2)));P1(1,2) = const2;

P2(1,1) = R(1,1) + (wr/2)*(z/ha);P2(1,2) = R(1,2) + (750+(la/2)- R(1,2))*(z/ha);

P3(1,1) = R(1,1) + (wr/2)*(z/ha);P3(1,2) = R(1,2) + (750 - (la/2) - R(1,2))*(z/ha);

P4(1,1) = R(1,1) + (wr/2)*((const1 - R(1,2))/(750 -(la/2) - R(1,2)));P4(1,2) = const1;

P5(1,1) = R(1,1) + (-wr/2)*((const1 - R(1,2))/(750 -(lb/2) - R(1,2)));P5(1,2) = const1;

P6(1,1) = R(1,1) + (-wr/2)*(z/hb);P6(1,2) = R(1,2) + (750 -(lb/2) - R(1,2))*(z/hb);

P7(1,1) = R(1,1) + (-wr/2)*(z/hb);P7(1,2) = R(1,2) + (750 +(lb/2) - R(1,2))*(z/hb);

P8(1,1) = R(1,1) + (-wr/2)*((const2 - R(1,2))/(750 +(lb/2) - R(1,2)));P8(1,2) = const2;

X1 = [P1(1,1) P2(1,1) P3(1,1) P4(1,1) P5(1,1) P6(1,1) P7(1,1) P8(1,1)];
Y1 = [P1(1,2) P2(1,2) P3(1,2) P4(1,2) P5(1,2) P6(1,2) P7(1,2) P8(1,2)];
Z1 = [z z z z z z z z];

end


if (R(1,2)<750+(la/2)) && (R(1,2)>750-(la/2)) && (R(1,2)<750+(lb/2)) && (R(1,2)<750-(lb/2))

P1(1,1) = R(1,1) + (wr/2)*((const2 - R(1,2))/(750+(la/2) - R(1,2)));P1(1,2) = const2;

P2(1,1) = R(1,1) + (wr/2)*(z/ha);P2(1,2) = R(1,2) + (750+(la/2)- R(1,2))*(z/ha);

P3(1,1) = R(1,1) + (wr/2)*(z/ha);P3(1,2) = R(1,2) + (750 - (la/2) - R(1,2))*(z/ha);

P4(1,1) = R(1,1) + (wr/2)*((const1 - R(1,2))/(750 -(la/2) - R(1,2)));P4(1,2) = const1;

P5(1,1) = const1;P5(1,2) = R(1,2) + (750 - (lb/2) - R(1,2))*((const1 - R(1,1))/(-wb - (wr/2)));

P6(1,1) = R(1,1) + (-(wr/2)-wb)*(z/hb);P6(1,2) = R(1,2) + (750 - (lb/2) - R(1,2))*(z/hb);

P7(1,1) = R(1,1) + (-wr/2)*(z/hb);P7(1,2) = R(1,2) + (750 - (lb/2) - R(1,2))*(z/hb);

P8(1,1) = R(1,1) + (-wr/2)*(z/hb);P8(1,2) = R(1,2) + (750 +(lb/2) - R(1,2))*(z/hb);

P9(1,1) = R(1,1) + (-wr/2)*((const2 - R(1,2))/(750 +(lb/2) - R(1,2)));P9(1,2) = const2;

X1 = [P1(1,1) P2(1,1) P3(1,1) P4(1,1) 0 P5(1,1) P6(1,1) P7(1,1) P8(1,1) P9(1,1) ];
Y1 = [P1(1,2) P2(1,2) P3(1,2) P4(1,2) 0 P5(1,2) P6(1,2) P7(1,2) P8(1,2) P9(1,2) ];
Z1 = [z z z z z z z z z z];

end


if (R(1,2)<750+(la/2)) && (R(1,2)<750-(la/2)) && (R(1,2)<750+(lb/2)) && (R(1,2)>750-(lb/2)) 

P1(1,1) = R(1,1) + (wr/2)*((const2 - R(1,2))/(750+(la/2) - R(1,2)));P1(1,2) = const2;

P2(1,1) = R(1,1) + (wr/2)*(z/ha);P2(1,2) = R(1,2) + (750+(la/2)- R(1,2))*(z/ha);

P3(1,1) = R(1,1) + (wr/2)*(z/ha);P3(1,2) = R(1,2) + (750 - (la/2) - R(1,2))*(z/ha);

P4(1,1) = R(1,1) + ((wr/2) + wa)*(z/ha);P4(1,2) = R(1,2) + (750 - (la/2) - R(1,2))*(z/ha);

P5(1,1) = const2;P5(1,2) = R(1,2) + (750 - (la/2) - R(1,2))*((const2 - R(1,1))/((wr/2) + wa));

P6(1,1) = R(1,1) + (-wr/2)*((const1 - R(1,2))/(750 -(lb/2) - R(1,2)));P6(1,2) = const1;

P7(1,1) = R(1,1) + (-wr/2)*(z/hb);P7(1,2) = R(1,2) + (750 -(lb/2) - R(1,2))*(z/hb);

P8(1,1) = R(1,1) + (-wr/2)*(z/hb);P8(1,2) = R(1,2) + (750 +(lb/2) - R(1,2))*(z/hb);

P9(1,1) = R(1,1) + (-wr/2)*((const2 - R(1,2))/(750 +(lb/2) - R(1,2)));P9(1,2) = const2;

X1 = [P1(1,1) P2(1,1) P3(1,1) P4(1,1) P5(1,1) 1500 P6(1,1) P7(1,1) P8(1,1) P9(1,1) ];
Y1 = [P1(1,2) P2(1,2) P3(1,2) P4(1,2) P5(1,2)  0 P6(1,2) P7(1,2) P8(1,2) P9(1,2) ];
Z1 = [z z z z z z z z z z];

end


if (R(1,2)<750+(la/2)) && (R(1,2)<750-(la/2)) && (R(1,2)<750+(lb/2)) && (R(1,2)<750-(lb/2)) 

P1(1,1) = R(1,1) + (wr/2)*((const2 - R(1,2))/(750+(la/2) - R(1,2)));P1(1,2) = const2;

P2(1,1) = R(1,1) + (wr/2)*(z/ha);P2(1,2) = R(1,2) + (750+(la/2)- R(1,2))*(z/ha);

P3(1,1) = R(1,1) + (wr/2)*(z/ha);P3(1,2) = R(1,2) + (750 - (la/2) - R(1,2))*(z/ha);

P4(1,1) = R(1,1) + ((wr/2) + wa)*(z/ha);P4(1,2) = R(1,2) + (750 - (la/2) - R(1,2))*(z/ha);

P5(1,1) = const2;P5(1,2) = R(1,2) + (750 - (la/2) - R(1,2))*((const2 - R(1,1))/((wr/2) + wa ));

P6(1,1) = const1;P6(1,2) = R(1,2) + (750 - (lb/2) - R(1,2))*((const1 - R(1,1))/(-wb - (wr/2)));

P7(1,1) = R(1,1) + (-(wr/2)-wb)*(z/hb);P7(1,2) = R(1,2) + (750 - (lb/2) - R(1,2))*(z/hb);

P8(1,1) = R(1,1) + (-wr/2)*(z/hb);P8(1,2) = R(1,2) + (750 - (lb/2) - R(1,2))*(z/hb);

P9(1,1) = R(1,1) + (-wr/2)*(z/hb);P9(1,2) = R(1,2) + (750 +(lb/2) - R(1,2))*(z/hb);

P10(1,1) = R(1,1) + (-wr/2)*((const2 - R(1,2))/(750 +(lb/2) - R(1,2)));P10(1,2) = const2;

X1 = [P1(1,1) P2(1,1) P3(1,1) P4(1,1) P5(1,1) 1500 0 P6(1,1) P7(1,1) P8(1,1) P9(1,1) P10(1,1)];
Y1 = [P1(1,2) P2(1,2) P3(1,2) P4(1,2) P5(1,2) 0 0 P6(1,2) P7(1,2) P8(1,2) P9(1,2) P10(1,2)];
Z1 = [z z z z z z z z z z z z];

end


if (R(1,2)<750+(la/2)) && (R(1,2)>750-(la/2)) && (R(1,2)>750+(lb/2)) && (R(1,2)>750-(lb/2)) 

P1(1,1) = R(1,1) + (wr/2)*((const2 - R(1,2))/(750+(la/2) - R(1,2)));P1(1,2) = const2;

P2(1,1) = R(1,1) + (wr/2)*(z/ha);P2(1,2) = R(1,2) + (750+(la/2)- R(1,2))*(z/ha);

P3(1,1) = R(1,1) + (wr/2)*(z/ha);P3(1,2) = R(1,2) + (750 - (la/2) - R(1,2))*(z/ha);

P4(1,1) = R(1,1) + (wr/2)*((const1 - R(1,2))/(750 -(la/2) - R(1,2)));P4(1,2) = const1;

P5(1,1) = R(1,1) + (-wr/2)*((const1 - R(1,2))/(750 -(lb/2) - R(1,2)));P5(1,2) = const1;

P6(1,1) = R(1,1) + (-wr/2)*(z/hb);P6(1,2) = R(1,2) + (750 -(lb/2) - R(1,2))*(z/hb);

P7(1,1) = R(1,1) + (-wr/2)*(z/hb);P7(1,2) = R(1,2) + (750 +(lb/2) - R(1,2))*(z/hb);

P8(1,1) = R(1,1) + (-(wr/2) - wb)*(z/hb);P8(1,2) = R(1,2) + (750 +(lb/2) - R(1,2))*(z/hb);

P9(1,1) = const1;P9(1,2) = R(1,2) + (750 +(lb/2) - R(1,2))*((const1 - R(1,1))/(-(wr/2) - wb));

X1 = [P1(1,1) P2(1,1) P3(1,1) P4(1,1) P5(1,1) P6(1,1) P7(1,1) P8(1,1) P9(1,1) 0];
Y1 = [P1(1,2) P2(1,2) P3(1,2) P4(1,2) P5(1,2) P6(1,2) P7(1,2) P8(1,2) P9(1,2) 1500];
Z1 = [z z z z z z z z z z ];

end


if (R(1,2)>750+(la/2)) && (R(1,2)>750-(la/2)) && (R(1,2)<750+(lb/2)) && (R(1,2)>750-(lb/2)) 

P1(1,1) = const2;P1(1,2) = R(1,1) + (750+(la/2) - R(1,2))*((const2 - R(1,1))/((wr/2) + wa));

P2(1,1) = R(1,1) + ((wr/2)+ wa)*(z/ha);P2(1,2) = R(1,2) + (750+(la/2)- R(1,2))*(z/ha);

P3(1,1) = R(1,1) + (wr/2)*(z/ha);P3(1,2) = R(1,2) + (750+(la/2)- R(1,2))*(z/ha);

P4(1,1) = R(1,1) + (wr/2)*(z/ha);P4(1,2) = R(1,2) + (750 - (la/2) - R(1,2))*(z/ha);

P5(1,1) = R(1,1) + (wr/2)*((const1 - R(1,2))/(750 -(la/2) - R(1,2)));P5(1,2) = const1;

P6(1,1) = R(1,1) + (-wr/2)*((const1 - R(1,2))/(750 -(lb/2) - R(1,2)));P6(1,2) = const1;

P7(1,1) = R(1,1) + (-wr/2)*(z/hb);P7(1,2) = R(1,2) + (750 -(lb/2) - R(1,2))*(z/hb);

P8(1,1) = R(1,1) + (-wr/2)*(z/hb);P8(1,2) = R(1,2) + (750 +(lb/2) - R(1,2))*(z/hb);

P9(1,1) = R(1,1) + (-wr/2)*((const2 - R(1,2))/(750 +(lb/2) - R(1,2)));P9(1,2) = const2;

X1 = [1500 P1(1,1) P2(1,1) P3(1,1) P4(1,1) P5(1,1) P6(1,1) P7(1,1) P8(1,1) P9(1,1)];
Y1 = [1500 P1(1,2) P2(1,2) P3(1,2) P4(1,2) P5(1,2) P6(1,2) P7(1,2) P8(1,2) P9(1,2)];
Z1 = [z z z z z z z z z z];

end


if (R(1,2)>750+(la/2)) && (R(1,2)>750-(la/2)) && (R(1,2)>750+(lb/2)) && (R(1,2)>750-(lb/2)) 

P1(1,1) = const2;P1(1,2) = R(1,2) + (750+(la/2) - R(1,2))*((const2 - R(1,1))/((wr/2) + wa));

P2(1,1) = R(1,1) + ((wr/2)+ wa)*(z/ha);P2(1,2) = R(1,2) + (750+(la/2)- R(1,2))*(z/ha);

P3(1,1) = R(1,1) + (wr/2)*(z/ha);P3(1,2) = R(1,2) + (750+(la/2)- R(1,2))*(z/ha);

P4(1,1) = R(1,1) + (wr/2)*(z/ha);P4(1,2) = R(1,2) + (750 - (la/2) - R(1,2))*(z/ha);

P5(1,1) = R(1,1) + (wr/2)*((const1 - R(1,2))/(750 -(la/2) - R(1,2)));P5(1,2) = const1;

P6(1,1) = R(1,1) + (-wr/2)*((const1 - R(1,2))/(750 -(lb/2) - R(1,2)));P6(1,2) = const1;

P7(1,1) = R(1,1) + (-wr/2)*(z/hb);P7(1,2) = R(1,2) + (750 -(lb/2) - R(1,2))*(z/hb);

P8(1,1) = R(1,1) + (-(wr/2) - wb)*(z/hb);P8(1,2) = R(1,2) + (750 -(lb/2) - R(1,2))*(z/hb);

P9(1,1) = R(1,1) + (-(wr/2) - wb)*(z/hb);P9(1,2) = R(1,2) + (750 +(lb/2) - R(1,2))*(z/hb);

P10(1,1) = const1;P10(1,2) = R(1,2) + (750 +(lb/2) - R(1,2))*((const1 - R(1,1))/(-(wr/2) - wb));

X1 = [1500 P1(1,1) P2(1,1) P3(1,1) P4(1,1) P5(1,1) P6(1,1) P7(1,1) P8(1,1) P9(1,1) P10(1,1) 0];
Y1 = [1500 P1(1,2) P2(1,2) P3(1,2) P4(1,2) P5(1,2) P6(1,2) P7(1,2) P8(1,2) P9(1,2) P10(1,2) 1500];
Z1 = [z z z z z z z z z z z z];

end



[Xb, Yb] = polybool('intersection', X,Y,X1,Y1);

num = numel(Xb);
for po=1:1:num;
    Zb(po,1) = z;
end


patch(Xb,Yb,Zb,'green');

voxel(a + [-wa/2,-la/2,0],[wa la ha],'c',0.7);
voxel(b + [-wb/2,-lb/2,0],[wb lb hb],'c',0.7);

axis([const1 const2 const1 const2 0 z]);
axis('square');




